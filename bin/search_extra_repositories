#!/bin/bash

# Verificar que se proporcionó un argumento
if [ $# -lt 1 ]; then
    echo "Uso: $0 <nombre_directorio>"
    exit 1
fi

# Asignar el argumento a una variable
new_directory="$1"

# Buscar el directorio
directory_found=$(find / -type d -name "$new_directory" 2>/dev/null)

# Verificar si se encontró el directorio
if [ -n "$directory_found" ]; then
    # Verificar si el archivo ya existe y contiene addons_path
    if [ -f "${ODOO_RC}" ]; then
        addons_line=$(grep -E "^addons_path=${ADDONS_PATH},${ADDONS_DIR}" "${ODOO_RC}")
        if [ -n "$addons_line" ]; then
            # Agregar el nuevo directorio a la línea existente
            sed -i "s|^addons_path=${ADDONS_PATH},${ADDONS_DIR}\(.*\)|addons_path=${ADDONS_PATH},${ADDONS_DIR}\1,$directory_found|g" "${ODOO_RC}"
        else
            # Si no existe la línea, agregarla con el nuevo directorio
            echo "addons_path=${ADDONS_PATH},${ADDONS_DIR},$directory_found" >> "${ODOO_RC}"
            cat "${ODOO_RC}"
        fi
    else
        # Si el archivo no existe, crearlo con la línea y el nuevo directorio
        echo "addons_path=${ADDONS_PATH},${ADDONS_DIR},$directory_found" > "${ODOO_RC}"
        cat "${ODOO_RC}"
    fi
else
    echo "El directorio $new_directory no fue encontrado."
fi
